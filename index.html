<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Converting CSV to JSON</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <link rel="stylesheet" href="">
    </head>
    <body>
        
            <script src="papaparse.min.js"></script>
            <script src="jquery-3.4.1.min.js"></script>


        
            <div class="container h-100">
                    <div class="row h-100 justify-content-center align-items-center">
                      <form class="col-12">
                        <div class="form-group">
                          <label for="formGroupExampleInput">Example label</label>
                          <input type="text" class="form-control" id="formGroupExampleInput" placeholder="Example input">
                        </div>
                        <div class="form-group">
                          <label for="formGroupExampleInput2">Another label</label>
                          <input type="text" class="form-control" id="formGroupExampleInput2" placeholder="Another input">
                        </div>
                      </form>   
                    </div>
                  </div>
            
            <input type="file" name="File Upload" id="txtFileUpload" accept=".csv" />
            

            <p>Total number of pairs sold at regular price: <a id="cReg"></a></p>
            <p>Total number of pairs sold without tax: <a id="cTax"></a></p>
            <p>Total number of pairs sold at 10 percent off: <a id="c10"></a></p>
            <p>Total number of pairs sold at 20 percent off: <a id="c20"></a></p>
            <p>Total number of pairs sold at 25 percent off: <a id="c25"></a></p>
            <p>Total number of pairs sold at 30 percent off: <a id="c30"></a></p>
            <p>Total number of pairs sold at 50 percent off: <a id="c50"></a></p>

    <script>
        
        document.getElementById('txtFileUpload').addEventListener('change', upload, false);
        
        var counter30 = 0;
        var counter25 = 0;
        var counter10 = 0;
        var counter20 = 0;
        var counter50 = 0;
        var counterTax = 0;
        var counterReg = 0;
        
        function upload(evt) {
            
            
            

            var file = evt.target.files[0];
            var reader = new FileReader();
            reader.readAsText(file);
            reader.onload = function(event) {
            var csvData = event.target.result;
            
            var results = Papa.parse(csvData, 
                {
                    header : false,
                    dynamicTyping: true
                });
            
            console.log(results);
            
            var i;
            for (i = 1; i < results.data.length-1; i++) {
                var discount = results.data[i][7] /results.data[i][5];

                if (results.data[i][8] == 0){
                    counterTax = counterTax + results.data[i][4];
                }
                else if ( (discount >= 0.699) && (discount<= 0.709) && (results.data[i][8] >= 0)) //if a 33% discount
                {
                    counter30 =  counter30 + results.data[i][4];
                }
                else if ( (discount >= 0.749) && (discount<= 0.759) && (results.data[i][8] >= 0)) //if transaction is a 25% discount
                {
                    counter25 = counter25 + results.data[i][4];
                }
                else if ( (discount >= 0.799) && (discount<= 0.809) && (results.data[i][8] >= 0)) //if transaction is a 20% discount
                {
                    counter20 = counter20 + results.data[i][4];
                }
                else if ( (discount >= 0.899) && (discount<= 0.909) && (results.data[i][8] >= 0)) //if transaction is a 10% discount
                {
                    counter10 = counter10 + results.data[i][4];
                }
                else if ( (discount >= 0.499) && (discount<= 0.509) && (results.data[i][8] >= 0)) //if transaction is a 50% discount
                {
                    counter50 = counter50 + results.data[i][4];
                }
                else if ( (discount >= 0.749) && (discount<= 0.759) && (results.data[i][8] >= 0)) //if transaction is a 25% discount
                {
                    counter25 = counter25 + results.data[i][4];
                }
                else
                {
                    counterReg = counterReg + results.data[i][4];
                }

            }
            
            document.getElementById("cReg").innerHTML = counterReg.toString();
            document.getElementById("cTax").innerHTML = counterTax.toString();
            document.getElementById("c10").innerHTML = counter10.toString();
            document.getElementById("c20").innerHTML = counter20.toString();
            document.getElementById("c25").innerHTML = counter25.toString();
            document.getElementById("c30").innerHTML = counter30.toString();
            document.getElementById("c50").innerHTML = counter50.toString();

            console.log(counter25);
            console.log(counter33);
            
            };
            reader.onerror = function() {
            alert('Unable to read ' + file.fileName);
            };
            
            }

            
            
            


            
        </script>
        
    </body>
</html>